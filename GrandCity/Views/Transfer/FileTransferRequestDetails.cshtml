@model MeherEstateDevelopers.Models.TransferRequestDetails
@{ Layout = "~/Views/Shared/_StaffLayout.cshtml"; }
<input type="hidden" id="file-id" value="@Model.FileData.Id" name="File_Form_Id">
<input type="hidden" id="blod-rel" value="false" />
<input type="hidden" id="Trans-val" value="false" />
<input type="hidden" id="oth-Trans-val" value="false" />
<input type="hidden" id="tran-id" value="@ViewBag.TransactionId" />
<div class="row gap-20 pos-r">
    <div class="col-md-12">
        <div class="bgc-white p-20 bd">
            <h3 style="text-align:center"><u>Review Transfer Request</u></h3>
            <div class="form-row row">
                <div class="col-md-12">
                    <div class="form-row">
                        @if (Model.FileData.Verified != true)
                        {
                            <div class="alert alert-danger" role="alert">This File is not Verified</div>
                        }
                        @if (Model.Balance.Balance_Amount < 0)
                        {
                            <div class="alert alert-danger" role="alert">This File Can not be Transfer Due to pending OVERDUE Amount</div>
                        }
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-1">
                            <label>File Form No.</label>
                            <h5>@Model.FileData.FileFormNumber</h5>
                        </div>
                        <div class="form-group col-md-2">
                            <label>Dealership</label>
                            <h5>@Model.FileData.Dealership_Name</h5>
                        </div>
                        <div class="form-group col-md-1">
                            <label>Plot Size</label>
                            <h5>@Model.FileData.Plot_Size</h5>
                        </div>
                        <div class="form-group col-md-2">
                            <label>Block</label>
                            <h5>@Model.FileData.Block</h5>
                        </div>
                        <div class=" form-group col-md-1">
                            @{
                                MeherEstateDevelopers.Models.FileStatus filestat = (MeherEstateDevelopers.Models.FileStatus)Model.FileData.Status;
                            }
                            <label>File Status</label>
                            <h5 id="status">@filestat.ToString()</h5>
                        </div>
                        <div class=" form-group col-md-2">
                            @{
                                string devch = "";
                                if (Model.FileData.Development_Charges == true)
                                {
                                    devch = "With Developement Charges";
                                }
                                else if (Model.FileData.Development_Charges == false)
                                {
                                    devch = "No Developement Charges";
                                }
                                else
                                {
                                    devch = "To Be Announced";
                                }
                            }
                            <label>Development Charges</label>
                            <h5 id="dev-char">@devch</h5>
                        </div>
                        <div class="form-group col-md-1">
                            <label>Balance</label>
                            <h5 id="bal-amt">@string.Format("{0:0,0.##}", Model.Balance.Balance_Amount)</h5>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="bgc-white p-20 bd">
            <h5 style="text-align:center" class="c-grey-900"><u>Seller Information</u></h5>
            <div class="mT-30">
                @foreach (var item in Model.FilesOwners)
                {
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label>Name</label>
                            <h5>@item.Name</h5>
                        </div>
                        <div class="form-group col-md-6">
                            <label>Father's/Husband's Name</label>
                            <h5>@item.Father_Husband</h5>
                        </div>
                        <div class="form-group col-md-12">
                            <label>Postal Address</label>
                            <h5>@item.Postal_Address</h5>
                        </div>
                        <div class="form-group col-md-12">
                            <label>Residential Address</label>
                            <h5>@item.Residential_Address</h5>
                        </div>
                        <div class="form-group col-md-3">
                            <label>City</label>
                            <h5>@item.City</h5>
                        </div>
                        <div class="form-group col-md-3">
                            <label>Date Of Birth</label>
                            <h5>@item.Date_Of_Birth</h5>
                        </div>
                        <div class="form-group col-md-3">
                            <label>CNIC / NICOP</label>
                            <h5>@item.CNIC_NICOP</h5>
                        </div>
                        <div class="form-group col-md-3">
                            <label>Occupation</label>
                            <h5>@item.Occupation</h5>
                        </div>
                        <div class="form-group col-md-3">
                            <label>Nationality</label>
                            <h5>@item.Nationality</h5>
                        </div>
                        <div class="form-group col-md-3">
                            <label>Email</label>
                            <h5>@item.Email</h5>
                        </div>
                        <div class="form-group col-md-3">
                            <label>Phone Office</label>
                            <h5>@item.Phone_Office</h5>
                        </div>
                        <div class="form-group col-md-3">
                            <label>Residential</label>
                            <h5>@item.Residential</h5>
                        </div>
                        <div class="form-group col-md-3">
                            <label>Mobile 1</label>
                            <h5>@item.Mobile_1</h5>
                        </div>
                        <div class="form-group col-md-3">
                            <label>Mobile 2</label>
                            <h5>@item.Mobile_2</h5>
                        </div>
                    </div>
                    <hr />
                    <h6 class="c-grey-900">Nominee</h6>
                    <div class="mT-30">
                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label>Name</label>
                                <h5>@item.Nominee_Name</h5>
                            </div>
                            <div class="form-group col-md-4">
                                <label>CNIC / NICOP</label>
                                <h5>@item.Nominee_CNIC_NICOP</h5>
                            </div>
                            <div class="form-group col-md-4">
                                <label>Relation</label>
                                <h5>@item.Nominee_Relation</h5>
                            </div>
                            <div class="form-group col-md-12">
                                <label>Address</label>
                                <h5>@item.Nominee_Address</h5>
                            </div>
                        </div>
                    </div>
                }
            </div>
            <hr />
            <h6 class="c-grey-900">Installments</h6>
            <div class="mT-30">
                <div class="form-row">
                    <div class="col-md-12">
                        <div style="min-height:0px; max-height:500px;overflow:auto" class=" ps--active-y">
                            <table class="table table-striped table-bordered" cellspacing="0" width="100%" style="margin-bottom:0px">
                                <thead class="thead-dark">
                                    <tr>
                                        <th>Installment</th>
                                        <th>Amount</th>
                                        <th>Due Date</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @{
                                        foreach (var item in Model.FileInstallments)
                                        {
                                            var statuscolor = "";
                                            if (item.Status == "NotPaid")
                                            {
                                                statuscolor = "bgc-red-50";
                                            }
                                            else if (item.Status == "Paid")
                                            {
                                                statuscolor = "bgc-green-50";
                                            }
                                            <tr class="@statuscolor">
                                                <td>@item.Installment_Name</td>
                                                <td>@string.Format("{0:n0}", item.Amount)</td>
                                                <td>@string.Format("{0:dd-MMM-yyyy}", item.Due_Date)</td>
                                                <td>@item.Status</td>
                                            </tr>
                                        }
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div style="min-height:0px; max-height:500px;overflow:auto" class=" ps--active-y">
                            <table class="table table-striped table-bordered instrecviewfile" cellspacing="0" width="100%" style="margin-bottom:0px">
                                <thead class="thead-dark">
                                    <tr>
                                        <th>Sr.</th>
                                        <th>Receipt No.</th>
                                        <th>Inst No.</th>
                                        <th>Type</th>
                                        <th>Status</th>
                                        <th>Amount</th>
                                        <th>Date</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @{ int srcount = 1;
                                        string[] Types = { "Booking", "Installment", "Advance" };
                                        foreach (var g in Model.FileReceipts.Where(x => Types.Contains(x.Type)).GroupBy(x => x.Type))
                                        {
                                            <tr><td colspan="8" style="text-align:center;font-size:15px"><b>@g.Key</b></td></tr>
                                            foreach (var item in g)
                                            {
                                                string stat = "";
                                                if (item.Status == "Pending")
                                                {
                                                    stat = "bgc-yellow-50";
                                                }
                                                else if (item.Status == "Dishonored")
                                                {
                                                    stat = "bgc-red-50";
                                                }
                                                else if (item.Status == "Approved")
                                                {
                                                    stat = "bgc-green-50";
                                                }
                                                else if (item.Status == "Deposited")
                                                {
                                                    stat = "bgc-orange-50";
                                                }
                                                else
                                                {
                                                    stat = "";
                                                }
                                                <tr class="@stat" id="@item.Id">
                                                    <td>@srcount</td>
                                                    @if (((item.ReceiptNo.Contains("-DIB") || item.ReceiptNo.Contains("-HBL")) && item.Userid != 0))
                                                    {
                                                        <td>
                                                            @item.ReceiptNo
                                                            <br>
                                                            Manual
                                                        </td>
                                                    }
                                                    else
                                                    {
                                                        <td>@item.ReceiptNo</td>
                                                    }
                                                    <td>@string.Format("{0:n0}", item.Ch_Pay_Draft_No)</td>
                                                    <td>@item.PaymentType</td>
                                                    <td>@item.Status</td>
                                                    <td>@string.Format("{0:n0}", item.Amount)</td>
                                                    <td>@string.Format("{0:dd-MMM-yyyy}", item.DateTime)</td>
                                                    <td>
                                                        @{
                                                            if (item.Verified == true)
                                                            {
                                                                <i class="ti-check" style="color:green"></i>
                                                            }
                                                        }
                                                    </td>
                                                </tr>
                                                srcount++;
                                            }
                                        }
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="bgc-white p-20 bd">
            <h5 style="text-align:center" class="c-grey-900"><u>Buyyer Information</u></h5>
            <div class="form-row">
                <div class="col-md-6">
                    <h5>Serial No: @Model.TransferTo.Select(x => x.TransferReqNo).FirstOrDefault()</h5>
                    <hr />
                    <h5>Transfer Charges: <span id="t-amt">@string.Format("{0:0,0.##}", ViewBag.TransferRate)</span></h5>
                    <hr />
                </div>
                <div class="col-md-6">
                    @if (Model.TransferTo.Any(x => x.Status != 0))
                    {
                        <i class="fa fa-pencil fa-2x snd-to-fd-btn float-right" type="button" data-grp="@Model.TransferTo.Select(x=>x.Group_Tag).FirstOrDefault()"></i>
                    }
                     <i class="fas fa-fingerprint fa-2x bio-verif-buyer-fl float-right" data-trans="@Model.TransferTo.Select(x=>x.Group_Tag).FirstOrDefault()"></i>
                </div>
            </div>
            <div class="form-row row">
                <div class="col-md-6">
                    <div class="form-row">
                        <div class="col-md-12">
                            <h6 style="width: auto;float: left;margin: 7px;">Blood Relation Transfer &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h6>
                            <label class="switch"><input type="checkbox" id="bl-rel"><span class="slider round"></span></label>
                        </div>
                    </div>
                    <hr />
                    <div class="form-row">
                        <div class="col-md-12">
                            <h6 style="width: auto;float: left;margin: 7px;">Transfer Charges Wave off &nbsp;</h6>
                            <label class="switch"><input type="checkbox" id="tran-ch"><span class="slider round"></span></label>
                        </div>
                    </div>
                    <hr />
                    <div class="form-row">
                        <div class="col-md-12">
                            <h6 style="width: auto;float: left;margin: 7px;">Other Transfer Charges &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h6>
                            <label class="switch"><input type="checkbox" id="oth-tran-ch"><span class="slider round"></span></label>
                        </div>
                        <div class="col-md-12 tran-amt" style="display:none">
                            <label>Rate / Marla</label>
                            <input class="form-control coma" name="Amount" value="@ViewBag.TransferRate" id="amt" placeholder="12,345" required>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 remarks" style="display:none">
                    <label>Remarks</label>
                    <textarea class="form-control" id="remarks" rows="10" style="resize:none"></textarea>
                </div>
            </div>
            <hr />
            @{ int cnt = 1;}
            @foreach (var item in Model.TransferTo)
            {
                <h5 style="text-align:center;">Owner # @(cnt++)</h5>
                <hr />
                <div class="form-row">
                    @if (Model.TransferTo.Any(x => x.IsCompanyProperty == true))
                    {
                        <div class="form-group col-md-6">
                            <label>Company Name</label>
                            <input type="text" class="form-control" value="@item.Name" id="Name" readonly>
                        </div>
                    }
                    else
                    {
                        <div class="form-group col-md-3">
                            <label>Name</label>
                            <input type="text" class="form-control" value="@item.Name" id="Name" readonly>
                        </div>
                        <div class="form-group col-md-3">
                            <label>Father's/Husband's Name</label>
                            <input type="text" class="form-control" id="Father_Husband" value="@item.Father_Husband" readonly>
                        </div>
                    }
                    <div class="form-group col-md-5">
                        <label>Postal Address</label>
                        <input type="text" class="form-control" id="Postal_Address" value="@item.Postal_Address" readonly>
                    </div>
                    <div class="form-group col-md-5">
                        <label>Residential Address</label>
                        <input type="text" class="form-control" id="Residential_Address" value="@item.Residential_Address" readonly>
                    </div>
                    <div class="form-group col-md-3">
                        <label>City</label>
                        <input type="text" class="form-control" id="City" value="@item.City" readonly>
                    </div>
                    @if (Model.TransferTo.Any(x => x.IsCompanyProperty == true))
                    {
                        <div class="form-group col-md-3">
                            <label>Date Of Incorp.</label>
                            <input type="text" class="form-control" id="Date_Of_Birth" value="@item.Date_Of_Birth" readonly>
                        </div>
                        <div class="form-group col-md-3">
                            <label>NTN</label>
                            <input type="text" class="form-control" id="CNIC_NICOP" value="@item.CNIC_NICOP" readonly>
                        </div>
                    }
                    else
                    {
                        <div class="form-group col-md-3">
                            <label>Date Of Birth</label>
                            <input type="text" class="form-control" id="Date_Of_Birth" value="@item.Date_Of_Birth" readonly>
                        </div>
                        <div class="form-group col-md-3">
                            <label>CNIC / NICOP</label>
                            <input type="text" class="form-control" id="CNIC_NICOP" value="@item.CNIC_NICOP" readonly>
                        </div>
                    }
                    <div class="form-group col-md-3">
                        <label>Occupation</label>
                        <input type="text" class="form-control" id="Occupation" value="@item.Occupation" readonly>
                    </div>
                    <div class="form-group col-md-3">
                        <label>Nationality</label>
                        <input type="text" class="form-control" id="Nationality" value="@item.Nationality" readonly>
                    </div>
                    <div class="form-group col-md-3">
                        <label>Email</label>
                        <input type="text" class="form-control" id="Email" value="@item.Email" readonly>
                    </div>
                    <div class="form-group col-md-3">
                        <label>Phone Office</label>
                        <input type="text" class="form-control" id="Phone_Office" value="@item.Phone_Office" readonly>
                    </div>
                    <div class="form-group col-md-3">
                        <label>Residential</label>
                        <input type="text" class="form-control" id="Residential" value="@item.Residential" readonly>
                    </div>
                    <div class="form-group col-md-3">
                        <label>Mobile 1</label>
                        <input type="text" class="form-control" id="Mobile_1" value="@item.Mobile_1" readonly>
                    </div>
                    <div class="form-group col-md-3">
                        <label>Mobile 2</label>
                        <input type="text" class="form-control" id="Mobile_2" value="@item.Mobile_2" readonly>
                    </div>
                </div>
                <hr />
                if (Model.TransferTo.Any(x => x.IsCompanyProperty == true))
                {
                    <h6 class="c-grey-900">Board Resolution</h6>
                }
                else
                {
                    <h6 class="c-grey-900">Nominee</h6>
                }
                <div class="mT-40">
                    <div class="form-row">
                        <div class="form-group col-md-3">
                            <label>Name</label>
                            <input type="text" class="form-control" id="Nominee_Name" value="@item.Nominee_Name" readonly>
                        </div>
                        <div class="form-group col-md-3">
                            <label>CNIC / NICOP</label>
                            <input type="text" class="form-control" id="Nominee_CNIC_NICOP" value="@item.Nominee_CNIC_NICOP" readonly>
                        </div>
                        <div class="form-group col-md-3">
                            <label>Relation</label>
                            <input class="form-control" id="Nominee_Relation" value="@item.Nominee_Relation" readonly>
                        </div>
                        <div class="form-group col-md-10">
                            <label>Address</label>
                            <input type="text" class="form-control" id="Nominee_Address" value="@item.Nominee_Address" readonly>
                        </div>
                    </div>
                </div>
            }
            @if (Model.TransferTo.Any(x => x.Transfer_Success != true && x.Status != 0))
            {
                <input type="hidden" value="@Model.TransferTo.Select(x=>x.Id).FirstOrDefault()" id="req-id" />
                <div class="form-row" id="trns-btn">
                    <button class="btn btn-success" data- type="button" id="transf-veri" style="width:100%;margin-top:10px">Reviewed & Transfer</button>
                </div>
            }
            else
            {
                <h3>This is Already Transfered</h3>
            }
        </div>
    </div>
</div>