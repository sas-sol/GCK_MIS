@{
    Layout = "~/Views/Shared/_StaffLayout.cshtml";
}
<!-- SweetAlert2 CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
<!-- SweetAlert2 JS -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<div class="row gap-20 pos-r">
    <div class="col-md-12">
        <div class="bgc-white p-20 bd">
            <div class="form-row">
                <div class="col-md-4">
                    <h6 class="c-grey-900">Application File Form</h6>
                </div>
        
            </div>
            <h6 class="c-grey-900"></h6>
            <div class="mT-30">
                <div class="form-row row">
                    <div class="col-md-9">
                        <div class="form-row">
                            <div class="form-group col-md-2">
                                <label>File Form No.</label>
                                <input type="hidden" class="form-control" id="module" value="FileManagement">
                                <input type="text" class="form-control" id="app-num" autocomplete="off">
                                <input type="hidden" id="plt-id">
                                <input type="hidden" id="file-id">
                                <input type="hidden" id="ttl-amt">
                                <input type="hidden" id="file-rate">
                            </div>
                            <div class="form-group col-md-3">
                                <label>Dealership</label>
                                <input type="text" class="form-control" id="deal-nam" readonly>
                            </div>
                            <div class="form-group col-md-1">
                                <label>Plot Size</label>
                                <input type="text" class="form-control" id="pl-size" readonly>
                            </div>
                            <div class="form-group col-md-2">
                                <label>Project</label>
                                <input type="text" class="form-control" id="prj" readonly>
                            </div>
                            <div class="form-group col-md-2">
                                <label>Phase</label>
                                <input type="text" class="form-control" id="phs" readonly>
                            </div>
                            <div class="form-group col-md-2">
                                <label>Block</label>
                                <input type="text" class="form-control" id="blk" readonly>
                            </div>
                            <div class="form-group col-md-2">
                                <button type="button" class="btn btn-primary my-4 get-f-res">Search File</button>
                            </div>
                            <div class="form-group col-md-2">
                                <button type="button" data-toggle="modal" data-target="#Modal" class="btn btn-info my-4 up-f-stat">Update File Status</button>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="col-md-3">
                                <h5>File Status : &nbsp;<span id="status">-</span></h5>
                            </div>
                            <div class="col-md-5">
                                <h3 id="dev-char"></h3>
                            </div>
                            <div class="col-md-4">
                                <h5>Balance : &nbsp;<span id="bal-amt">-</span></h5>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <img src="~/assets/static/images/no-img.png" width="200" height="200" id="qr_img" />
                    </div>
                </div>
            </div>
            <hr />
            <div class="form-row">
                <div class="col-md-3">
                    <h6 class="c-grey-900">Personal Information</h6>
                </div>
                <div class="col-md-3">
                    <button class="btn btn-info" id="upd-info">Update Information</button>
                    <button class="btn btn-success" data-toggle="modal" data-target="#Modal" id="new-owner-hkad">Add Another</button>
                </div>
                <label class="col-md-2 col-form-label">Plot Prefrence</label>
                <div class="col-md-3">
                    <select class="form-control" id="Plot_Prefrence">
                        <option value="">Select Plot Prefrence</option>
                        <option value="Normal">Normal</option>
                        <option value="Corner">Corner</option>
                        <option value="Facing Park">Facing Park</option>
                        <option value="Boulevard">Boulevard</option>
                        <option value="Boulevard Corner">Boulevard Corner</option>
                        <option value="Central Commercial Park Facing">Central Commercial Park Facing</option>
                    </select>
                </div>
            </div>

            <div class="mT-30 up-info owners-trail-fjhdsf">

            </div>

            @*<div class="form-row">
                @using (Html.BeginForm("FiesImageUploader", "FileSystem", FormMethod.Post, new { @id = "file-imge", @class = "", role = "form", enctype = "multipart/form-data" }))
                {

                    <div class="col-md-3" id="1">
                        <input type="hidden" name="ImageId" class="Plot_id"/>
                        <input type="hidden" name="File_Id" class="file_id" />
                        <input type="file" id="file1" name="File"><br>
                        <img src="/assets/static/images/def-img.png" id="img1" class="img1" width="200" height="200"><br>
                        <button class="btn btn-success btn_gen__poss" style="margin-top:10px" type="submit" name="" value="1">Save Image</button>
                    </div>
                }
                @using (Html.BeginForm("FiesImageUploader", "FileSystem", FormMethod.Post, new { @id = "file-imge", @class = "", role = "form", enctype = "multipart/form-data" }))
                {
                    <div class="col-md-3" id="2">
                        <input type="hidden" name="ImageId" class="Plot_id" />
                        <input type="hidden" name="File_Id" class="file_id" />
                        <input type="file" id="file2" name="File"><br>
                        <img src="/assets/static/images/def-img.png" id="img2" class="img1" width="200" height="200"><br>
                        <button class="btn btn-success btn_gen__poss" style="margin-top:10px" type="submit" name="" value="2">Save Image</button>
                    </div>
                }
                @using (Html.BeginForm("FiesImageUploader", "FileSystem", FormMethod.Post, new { @id = "file-imge", @class = "", role = "form", enctype = "multipart/form-data" }))
                {
                    <div class="col-md-3" id="3">
                        <input type="hidden" name="ImageId" class="Plot_id" />
                        <input type="hidden" name="File_Id" class="file_id" />
                        <input type="file" id="file3" name="File" value="3"><br>
                        <img src="/assets/static/images/def-img.png" id="img3" class="img1" width="200" height="200">
                        <button class="btn btn-success btn_gen__poss" style="margin-top:10px" type="submit" name="" value="3">Save Image</button>
                    </div>
                }
                @using (Html.BeginForm("FiesImageUploader", "FileSystem", FormMethod.Post, new { @id = "file-imge", @class = "", role = "form", enctype = "multipart/form-data" }))
                {
                    <div class="col-md-3" id="4">
                        <input type="hidden" name="ImageId" class="Plot_id" />
                        <input type="hidden" name="File_Id" class="file_id" />
                        <input type="file" id="file4" name="File"><br>
                        <img src="/assets/static/images/def-img.png" id="img4" class="img1" width="200" height="200">
                        <button class="btn btn-success btn_gen__poss" style="margin-top:10px" type="submit" name="" value="4">Save Image</button>
                    </div>
                }

            </div>*@

            <hr />
            <div class="form-row">
                <div class="col-md-2">
                    <h6 class="c-grey-900">Installments</h6>
                </div>
               
                <div class="col-md-2">
                    <button type="button" class="fil-disc btn btn-info" data-toggle="modal" data-target="#Modal">Add Discounts</button>
                </div>
            </div>
            <div class="mT-30">
                <div class="form-row">
                    <div class="col-md-6">
                        @*<div class="row">
                            <div class="col-md-2">
                                <i class="fas fa-angle-double-left pointer" id="shft-inst-pln-l" title="Shift Plan to Previous Month" style="float: Left;"> </i>
                                <i class="fas fa-angle-double-right pointer" id="shft-inst-pln-r" title="Shift Plan to Next Month" style="float: right;"> </i>
                            </div>

                            <div class="col-md-2">
                                <i class="fa fa-plus pointer installment-plan-row-add" data-toggle="modal" data-target="#Modal" title="Add Row" style="float: right;color: #3ADBA6"> </i>
                            </div>
                              <div class="col-md-2">
                                <i class="fas fa-exchange-alt pointer" id="ch-inst-plan" data-toggle="modal" data-target="#Modal" title="Change Installment Plan" style="float: right;"> </i>
                            </div>
                        </div>*@
                        
                        <table class="table table-striped table-bordered" cellspacing="0" width="100%" style="margin-bottom:0px">
                            <thead class="thead-dark">
                                <tr>
                                    <th>Sr.</th>
                                    <th><button class="btn btn-primary up_inst_btn_file" data-toggle="modal" data-target="#Modal">Update Installment</button></th>
                                    @*<th><button class="btn btn-secondary" id="on-btn-man" name="rece-btn-man" data-toggle="modal" data-target="#Modal">Online Receipts</button></th>
                                    <th><button class="btn btn-success" id="rece-btn-man" name="rece-btn-man" data-toggle="modal" data-target="#Modal">Manual Installment</button>*@
                                    
                                </tr>
                            </thead>
                        </table>
                        <div style="min-height:0px; max-height:500px;overflow:auto" class=" ps--active-y">
                            <table class="table table-striped table-bordered" id="all-instments" cellspacing="0" width="100%">
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div style="min-height:0px; max-height:800px;overflow:auto" class=" ps--active-y">
                            <table class="table table-striped table-bordered" id="oth-inst" cellspacing="0" width="100%">
                                <thead class="thead-dark">
                                    <tr>
                                        <th>Sr.</th>
                                        <th>Installment Name</th>
                                        <th>Amount</th>
                                        <th>Date</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                            <div style="min-height:0px; max-height:500px;overflow:auto" class=" ps--active-y">
                                <table class="table table-striped table-bordered" id="rec-amts" cellspacing="0" width="100%">
                                    <thead class="thead-dark">
                                        <tr>
                                            <th>Receipt No.</th>
                                            <th>Amount</th>
                                            <th>Bank</th>
                                            <th>Date</th>
                                            <th>Type</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                        <div style="min-height:0px; max-height:500px;overflow:auto;display:none" class="dis ps--active-y">
                            <h5>Discounts</h5>
                            <table class="table table-striped table-bordered" id="dis-amts" cellspacing="0" width="100%">
                                <thead class="thead-dark">
                                    <tr>
                                        <th>Total Amount</th>
                                        <th>Discount</th>
                                        <th>Percentage</th>
                                        <th>Remarks</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    $('.btn_gen__poss').hide();

    $('#new-owner-hkad').unbind().click(function () {
        let flId = $('#file-id').val();
        EmptyModel();
        $('#ModalLabel').text("Add Owner");
        $('.modal-body').load('/FileSystem/NewFileOwner/', { fileId: flId }, function () {
        });
    });
    //
    $(document).on('click', '.installment-plan-row-del', function () {
        var id = $(this).attr('data-ins-id');
        var insname = $(this).attr('data-ins-name');
        if (insname != "Advance") {
            var reason = prompt("Reason");
            if (reason != "" && reason != null) {
                $.ajax({
                    type: "POST",
                    url: '/Installments/DeletePlotInstallment/',
                    data: { insId: id, comment: reason },
                    success: function (data) {
                        alert(insname + " deleted successfully.");
                        window.location.reload();
                    },
                    error: function () {
                        alert("Error Occured");
                    }
                });
            }
        }
        else {
            alert("Advance cannot be deleted.");
        }
    });
   
</script>